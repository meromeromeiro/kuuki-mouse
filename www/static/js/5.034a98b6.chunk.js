"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[5],{7005:(t,e,n)=>{n.r(e),n.d(e,{default:()=>s});var r=n(5043);function o(t){try{const e=atob(t.replace(/\s/g,""));try{return decodeURIComponent(escape(e))}catch{const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return new TextDecoder("utf-8").decode(t)}}catch(e){return console.error("Base64 \u89e3\u7801\u5931\u8d25:",e),"[\u65e0\u6cd5\u89e3\u6790\u7684\u5185\u5bb9]"}}function a(){const[t,e]=(0,r.useState)((()=>localStorage.getItem("lastMessageId")||"0")),n=async()=>{const n=await async function(t){try{const e=await fetch(`https://chat.moonchan.xyz/api/message/me?after=${t||""}`);if(!e.ok)throw new Error("\u8bf7\u6c42\u5931\u8d25");return await e.json()}catch(e){return console.error("\u83b7\u53d6\u6d88\u606f\u5931\u8d25:",e),[]}}(t);if(n.length>0){n.forEach(a);const t=function(t){return t.reduce(((t,e)=>e.id>t?e.id:t),"0")}(n);e(t),localStorage.setItem("lastMessageId",t.toString())}},a=t=>{"granted"===Notification.permission&&new Notification(`\u65b0\u6d88\u606f ${new Date(parseInt(t.id)/65536).toLocaleString()}`,{body:o(t.payload),icon:"/notification-icon.png"})};return(0,r.useEffect)((()=>{Notification.requestPermission();const t=setInterval(n,3e4);return n(),()=>clearInterval(t)}),[]),null}var c=n(579);const s=function(){return(0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{children:"\u6d88\u606f\u901a\u77e5\u7cfb\u7edf"}),(0,c.jsx)(a,{})]})}}}]);
//# sourceMappingURL=5.034a98b6.chunk.js.map