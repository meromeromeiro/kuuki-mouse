{"version":3,"file":"static/js/986.251a0351.chunk.js","mappings":"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","sources":["upload/FileInfo.jsx","upload/FileUploader.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nconst FileInfo = ({ file }) => {\n  const [uploadStatus, setUploadStatus] = useState('idle'); // idle, uploading, done, error\n  const [fileUrl, setFileUrl] = useState(null);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  useEffect(() => {\n    if (file) {\n      handleUpload();\n    }\n  }, [file]); // 当 file 发生变化时自动触发上传\n\n  if (!file) {\n    return <div>没有选择文件</div>;\n  }\n\n  // 上传文件\n  const handleUpload = async () => {\n    setUploadStatus('uploading');\n    setErrorMessage('');\n\n    try {\n      const response = await fetch('https://wsl.moonchan.xyz/api/files/upload', {\n        method: 'PUT',\n        body: file,\n        headers: {\n          'Content-Type': file.type,\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error('上传失败');\n      }\n\n      const data = await response.json();\n      setFileUrl(`https://chat.moonchan.xyz/api/files/${data.id}/${file.name}`);\n      setUploadStatus('done');\n    } catch (error) {\n      setUploadStatus('error');\n      setErrorMessage(error.message);\n    }\n  };\n\n  // 复制链接到剪贴板\n  const handleCopyLink = () => {\n    if (fileUrl) {\n      navigator.clipboard.writeText(fileUrl).then(() => {\n        // alert('链接已复制到剪贴板！');\n      });\n    }\n  };\n\n  // 文件大小格式化\n  const fileSizeInMB = (file.size / (1024 * 1024)).toFixed(2);\n\n  return (\n    <div className=\"p-6 max-w mx-auto bg-white rounded-xl shadow-md space-y-4\">\n      <ul className=\"list-disc ml-5 space-y-2\">\n        <li>文件名: <span className=\"font-mono\">{file.name}</span></li>\n        <li>文件类型: <span className=\"font-mono\">{file.type || '未知'}</span></li>\n        <li>文件大小: <span className=\"font-mono\">{fileSizeInMB} MB</span></li>\n      </ul>\n\n      {/* 上传状态显示 */}\n      <div className=\"flex items-center space-x-4\">\n        {uploadStatus === 'uploading' && (\n          <span className=\"text-blue-500\">上传中...</span>\n        )}\n\n        {uploadStatus === 'done' && (\n          <div className=\"flex items-center space-x-2\">\n            <span className=\"text-green-500\">上传成功！</span>\n            <a\n              href={fileUrl}\n              download\n              className=\"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600\"\n            >\n              下载文件\n            </a>\n            <button\n              onClick={handleCopyLink}\n              className=\"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600\"\n            >\n              复制链接\n            </button>\n          </div>\n        )}\n\n        {uploadStatus === 'error' && (\n          <span className=\"text-red-500\">{errorMessage}</span>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default FileInfo;","import { useState } from 'react';\nimport FileInfo from './FileInfo';\nimport { Main } from '../App';\nimport Nav from '../Nav';\n\nexport default function IFrame() {\n  return <Main><Nav /><iframe\n    src=\"https://chat.moonchan.xyz/api/files/upload\"\n    className=\"w-full h-full flex-grow border-0\"\n    title=\"Content\"\n  /></Main>\n\n}\n\nexport function FileUploader() {\n  const [files, setFiles] = useState([]);\n  // const [uploadResults, setUploadResults] = useState([]);\n\n  // 处理文件选择\n  const handleFileSelect = async (e) => {\n    const selectedFiles = Array.from(e.target.files);\n    if (selectedFiles.length === 0) return;\n\n    setFiles(selectedFiles);\n    // await uploadFiles(selectedFiles);\n  };\n\n  // 上传所有文件\n  // const uploadFiles = async (filesToUpload) => {\n  //   const uploadPromises = filesToUpload.map(async (file) => {\n  //     const result = {\n  //       id: null,\n  //       fileName: file.name,\n  //       status: 'uploading',\n  //       error: null\n  //     };\n\n  //     try {\n  //       const response = await fetch('https://chat.moonchan.xyz/api/files/upload', {\n  //         method: 'PUT',\n  //         body: file,\n  //         headers: {\n  //           'Content-Type': file.type,\n  //         },\n  //       });\n\n  //       if (!response.ok) throw new Error('Upload failed');\n\n  //       const data = await response.json();\n  //       result.status = 'done';\n  //       result.id = data.id;\n  //     } catch (error) {\n  //       result.status = 'error';\n  //       result.error = error.message;\n  //     }\n\n  //     return result;\n  //   });\n\n  //   // 更新上传结果\n  //   const results = await Promise.all(uploadPromises);\n  //   setUploadResults(results);\n  // };\n\n  return (\n    <Main><Nav />\n      <div className=\"max-w-2xl mx-auto p-6 \">\n        {/* 文件上传区域 */}\n        <label className=\"block mb-8\">\n          <span className=\"sr-only\">选择上传文件</span>\n          <input\n            type=\"file\"\n            multiple\n            onChange={handleFileSelect}\n            className=\"block w-full text-sm text-gray-500\n            file:mr-4 file:py-2 file:px-4\n            file:rounded-full file:border-0\n            file:text-sm file:font-semibold\n            file:bg-blue-50 file:text-blue-700\n            hover:file:bg-blue-100\"\n          />\n        </label>\n\n        {files.map((file, index) => {\n          console.log(file)\n          return <FileInfo key={index} file={file}></FileInfo>\n        })}\n        {/* 上传结果列表 */}\n        {/* \n      {uploadResults.length > 0 && (\n        <div className=\"space-y-4\">\n          {uploadResults.map((result, index) => (\n            <div\n              key={index}\n              className=\"flex items-center justify-between p-4 border rounded-lg\"\n            >\n              <div className=\"flex items-center space-x-3\">\n                <span className=\"font-medium\">{result.fileName}</span>\n                <StatusBadge status={result.status} />\n              </div>\n\n              {result.status === 'done' && (\n                <a\n                  href={`https://chat.moonchan.xyz/api/files/${result.id}/${result.fileName}`}\n                  download\n                  className=\"px-3 py-1 text-sm text-blue-600 hover:text-blue-800 hover:underline\"\n                >\n                  下载\n                </a>\n              )}\n            </div>\n          ))}\n        </div>\n      )} */}\n      </div></Main>\n  );\n}\n\n// 状态标记组件\n// function StatusBadge({ status }) {\n//   const statusConfig = {\n//     uploading: {\n//       text: '上传中...',\n//       color: 'bg-yellow-100 text-yellow-800',\n//     },\n//     done: {\n//       text: '上传成功',\n//       color: 'bg-green-100 text-green-800',\n//     },\n//     error: {\n//       text: '上传失败',\n//       color: 'bg-red-100 text-red-800',\n//     },\n//   };\n\n//   const { text, color } = statusConfig[status] || {};\n\n//   return (\n//     <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${color}`}>\n//       {text}\n//     </span>\n//   );\n// }"],"names":["_ref","file","uploadStatus","setUploadStatus","useState","fileUrl","setFileUrl","errorMessage","setErrorMessage","useEffect","handleUpload","_jsx","children","async","response","fetch","method","body","headers","type","ok","Error","data","json","id","name","error","message","fileSizeInMB","size","toFixed","_jsxs","className","href","download","onClick","handleCopyLink","navigator","clipboard","writeText","then","IFrame","Main","Nav","src","title","FileUploader","files","setFiles","multiple","onChange","selectedFiles","Array","from","e","target","length","map","index","console","log","FileInfo"],"sourceRoot":""}