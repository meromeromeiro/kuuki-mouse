"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[314],{4314:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var r=a(5043),n=a(8619),s=a(5772),l=a(579);const o=[{id:"moonchan/groq",name:"Groq",url:"https://moonchan.xyz/groq",models:[{id:"qwen/qwen3-32b",name:"Qwen3-32B"},{id:"moonshotai/kimi-k2-instruct",name:"Kimi K2 Instruct"},{id:"deepseek-r1-distill-llama-70b",name:"DeepSeek R1 Distill Llama 70B"},{id:"gemma2-9b-it",name:"Gemma 2 Instruct"},{id:"llama-3.1-8b-instant",name:"Llama 3.1 8B"},{id:"llama-3.3-70b-versatile",name:"Llama 3.3 70B"},{id:"llama-guard-3-8b",name:"Llama Guard 3"},{id:"llama3-70b-8192",name:"Llama 3 70B"},{id:"llama3-8b-8192",name:"Llama 3 8B"},{id:"meta-llama/llama-4-maverick-17b-128e-instruct",name:"Llama 4 Maverick 17B 128E"},{id:"meta-llama/llama-4-scout-17b-16e-instruct",name:"Llama 4 Scout 17B 16E"},{id:"meta-llama/llama-guard-4-12b",name:"Llama Guard 4 12B"},{id:"mistral-saba-24b",name:"Mistral Saba 24B"},{id:"qwen-qwq-32b",name:"QwQ 32B"},{id:"whisper-large-v3",name:"Whisper"},{id:"whisper-large-v3-turbo",name:"Whisper Large V3 Turbo"}],defaultModelId:"meta-llama/llama-4-maverick-17b-128e-instruct"},{id:"moonchan/chutes",name:"Chutes",url:"https://moonchan.xyz/groq?service=chutes",models:[{id:"deepseek-ai/DeepSeek-V3-0324",name:"DeepSeek-V3-0324"},{id:"deepseek-ai/DeepSeek-Prover-V2-671B",name:"DeepSeek-Prover-V2-671B"},{id:"deepseek-ai/DeepSeek-R1",name:"DeepSeek-R1"},{id:"deepseek-ai/DeepSeek-V3",name:"DeepSeek-V3"},{id:"tngtech/DeepSeek-R1T-Chimera",name:"DeepSeek-R1T-Chimera"},{id:"Qwen/Qwen3-235B-A22B",name:"Qwen3-235B-A22B"},{id:"Qwen/Qwen3-30B-A3B",name:"Qwen3-30B-A3B"},{id:"Qwen/Qwen3-32B",name:"Qwen3-32B"},{id:"Qwen/Qwen3-14B",name:"Qwen3-14B"},{id:"Qwen/Qwen3-8B",name:"Qwen3-8B"},{id:"Qwen/Qwen2.5-VL-32B-Instruct",name:"Qwen2.5-VL-32B-Instruct"},{id:"chutesai/Llama-4-Maverick-17B-128E-Instruct-FP8",name:"Llama-4-Maverick-17B-128E-Instruct-FP8"}],defaultModelId:"deepseek-ai/DeepSeek-V3-0324"}];const i=function(){const[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),[m,u]=(0,r.useState)(o[0].id),[g,x]=(0,r.useState)(o[0].defaultModelId),[p,h]=(0,r.useState)(.7),[b,f]=(0,r.useState)(65536),[v,w]=(0,r.useState)(1),[y,j]=(0,r.useState)(""),[N,k]=(0,r.useState)(null),[S,B]=(0,r.useState)(null),C=(0,r.useRef)(null),I=(0,r.useRef)(null),E=(0,r.useRef)(null),Q=o.find((e=>e.id===m))||o[0],D=Q.models;(0,r.useEffect)((()=>{const e=o.find((e=>e.id===m));e&&!e.models.find((e=>e.id===g))&&x(e.defaultModelId)}),[m,g]),(0,r.useEffect)((()=>{C.current&&C.current.scrollIntoView({behavior:"smooth"})}),[e]),(0,r.useEffect)((()=>{if(e.length>0){const a=e[e.length-1];var t;if("assistant"===a.role&&"string"===typeof a.content&&c)null===(t=C.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})}}),[e,c]);const P=(0,r.useCallback)((()=>{I.current&&(I.current.abort(),console.log("Streaming stopped by user."))}),[]),V=(0,r.useCallback)((async()=>{if(!a.trim()&&!N)return;c&&I.current&&P();const r=[];if(a.trim()&&r.push({type:"text",text:a.trim()}),N&&r.push({type:"image_url",image_url:{url:N}}),0===r.length)return;const n={role:"user",content:r},s=e;t((e=>[...e,n,{role:"assistant",content:""}])),i(""),k(null),B(null),d(!0),I.current=new AbortController;const l=I.current.signal,o=[...s,n],m={model:g,messages:o,temperature:p,...Q.id.includes("groq")?{}:{max_completion_tokens:b},top_p:v,stop:y?y.split(",").map((e=>e.trim())).filter(Boolean):null,stream:!0};try{const e=await fetch(Q.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m),signal:l});if(!e.ok){let a=`API Error: ${e.status} ${e.statusText}`;try{var u;const t=await e.text(),r=JSON.parse(t);a+=` - ${(null===(u=r.error)||void 0===u?void 0:u.message)||r.message||JSON.stringify(r)}`}catch(f){a+=` (Failed to parse error details: ${f instanceof Error?f.message:String(f)})`}return t((e=>{const t=[...e];return t.length>0&&"assistant"===t[t.length-1].role&&(t[t.length-1].content=a),t})),void d(!1)}if(!e.body)throw new Error("Response body is null");const a=e.body.getReader(),r=new TextDecoder;let n=!1;for(;!n;){if(l.aborted)throw new DOMException("Aborted by user","AbortError");const{value:e,done:s}=await a.read();n=s;const o=r.decode(e,{stream:!n}).split("\n");for(const a of o)if(a.startsWith("data: ")){const e=a.substring(5).trim();if("[DONE]"===e){n=!0;break}if(!e)continue;try{var x,h;const a=JSON.parse(e);let r="";a.choices&&null!==(x=a.choices[0])&&void 0!==x&&null!==(h=x.delta)&&void 0!==h&&h.content&&(r=a.choices[0].delta.content),r&&t((e=>{const t=[...e],a=t.length-1;return a>=0&&"assistant"===t[a].role&&(t[a].content=t[a].content+r),t}))}catch(f){console.warn("Failed to parse stream chunk JSON:",e,f)}}}}catch(w){if(w instanceof DOMException&&"AbortError"===w.name)console.log("Fetch aborted."),t((e=>{const t=[...e],a=t.length-1;if(a>=0&&"assistant"===t[a].role){if(""===t[a].content)return t.slice(0,-1);t[a].content+="\n[Streaming cancelled by user]"}return t}));else{console.error("Error sending message or processing stream:",w);const e=`Error: ${w instanceof Error?w.message:String(w)}`;t((t=>{const a=[...t],r=a.length-1;return r>=0&&"assistant"===a[r].role?(a[r].content=(a[r].content||"")+`\n[Error: ${e}]`,a):[...a,{role:"assistant",content:`[Error: ${e}]`}]}))}}finally{d(!1),I.current=null}}),[a,N,c,g,e,p,b,v,y,Q,i,d,t,P,k,B]),L=()=>{P(),t([]),k(null),B(null),E.current&&(E.current.value="")},A=e=>{let{label:t,type:a,value:r,onChange:n,step:s,min:o,max:i,showValue:c=!1}=e;return(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-1 flex justify-between",children:[t," ",c&&"range"===a&&(0,l.jsxs)("span",{children:["(",r,")"]})]}),(0,l.jsx)("input",{type:a,value:r,onChange:n,step:s,min:o,max:i,className:"w-full p-2 border border-gray-600 rounded bg-gray-700 text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})};return(0,l.jsxs)("div",{className:"flex flex-col md:flex-row h-screen bg-gray-800 text-white font-sans",children:[(0,l.jsxs)("div",{className:"flex-1 flex flex-col p-4 md:p-6 bg-gray-800",children:[(0,l.jsx)("header",{className:"mb-4",children:(0,l.jsx)("h1",{className:"text-2xl font-semibold text-indigo-400",children:"AI Chat Interface (Streaming)"})}),(0,l.jsxs)("div",{className:"flex-grow overflow-y-auto space-y-4 pr-2 custom-scrollbar",children:[e.map(((e,t)=>(0,l.jsx)("div",{className:"flex "+("user"===e.role?"justify-end":"justify-start"),children:(0,l.jsxs)("div",{className:"max-w-xl p-3 rounded-xl shadow-md "+("user"===e.role?"bg-indigo-600 text-white rounded-br-none":"bg-gray-700 text-gray-200 rounded-bl-none"),children:[(0,l.jsxs)("div",{className:"flex items-center mb-1",children:["user"===e.role?(0,l.jsx)(s.JXP,{className:"mr-2 text-indigo-300"}):(0,l.jsx)(s.Ojn,{className:"mr-2 text-green-400"}),(0,l.jsx)("span",{className:"text-xs font-semibold",children:"user"===e.role?"You":"Assistant"})]}),(0,l.jsx)("div",{className:"prose prose-sm prose-invert max-w-none break-words",children:"assistant"===e.role?(0,l.jsx)(n.o,{children:e.content||"\u258b"}):e.content.map(((e,t)=>"text"===e.type?(0,l.jsx)("p",{className:"whitespace-pre-wrap my-0.5",children:e.text},t):"image_url"===e.type?(0,l.jsx)("img",{src:e.image_url.url,alt:"Uploaded content",className:"max-w-full sm:max-w-xs max-h-64 my-2 rounded-md object-contain bg-gray-600"},t):null))})]})},t))),(0,l.jsx)("div",{ref:C})]}),(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-700",children:[N&&(0,l.jsxs)("div",{className:"mb-3 p-2 bg-gray-750 rounded-lg flex items-center space-x-3 shadow",children:[(0,l.jsx)("img",{src:N,alt:S||"Preview",className:"h-16 w-16 object-cover rounded-md border border-gray-600"}),(0,l.jsx)("span",{className:"text-sm text-gray-300 truncate flex-grow max-w-[calc(100%-100px)]",children:S||"Uploaded Image"}),(0,l.jsx)("button",{onClick:()=>{k(null),B(null),E.current&&(E.current.value="")},className:"text-red-400 hover:text-red-300 p-1.5 rounded-full hover:bg-gray-600 transition-colors",title:"Remove image",children:(0,l.jsx)(s.q_G,{size:22})})]}),(0,l.jsxs)("div",{className:"flex items-end space-x-2",children:[(0,l.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=E.current)||void 0===e?void 0:e.click()},className:"p-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 focus:ring-2 focus:ring-teal-500 focus:outline-none h-[58px] flex items-center justify-center transition-colors duration-150 shrink-0",title:"Upload Image (PNG, JPG, GIF, WebP)",disabled:c&&!I.current,children:(0,l.jsx)(s.B88,{size:20})}),(0,l.jsx)("input",{type:"file",ref:E,accept:"image/png, image/jpeg, image/gif, image/webp",onChange:e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){if(a.size>20971520)return alert("Image size should not exceed 20MB."),void(E.current&&(E.current.value=""));if(!["image/png","image/jpeg","image/gif","image/webp"].includes(a.type))return alert("Invalid file type. Please upload PNG, JPEG, GIF, or WebP."),void(E.current&&(E.current.value=""));const e=new FileReader;e.onloadend=()=>{k(e.result),B(a.name)},e.readAsDataURL(a)}E.current&&(E.current.value="")},className:"hidden"}),(0,l.jsx)("textarea",{rows:3,value:a,onChange:e=>i(e.target.value),placeholder:"Type your message or upload an image...",className:"flex-grow p-3 border border-gray-600 rounded-lg bg-gray-700 text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none custom-scrollbar min-h-[58px] max-h-[150px]",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),V())},disabled:c&&!I.current}),c&&I.current?(0,l.jsx)("button",{onClick:P,className:"p-3 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:outline-none transition-colors duration-150 flex items-center justify-center h-[58px] shrink-0",title:"Stop Generating",children:(0,l.jsx)(s.cRw,{size:20})}):(0,l.jsx)("button",{onClick:V,disabled:!a.trim()&&!N||c&&!I.current,className:"p-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150 flex items-center justify-center h-[58px] shrink-0",children:(0,l.jsx)(s.kGk,{size:20})})]}),c&&(0,l.jsx)("p",{className:"text-xs text-gray-400 mt-1 text-center",children:"Assistant is typing..."})]})]}),(0,l.jsxs)("div",{className:"w-full md:w-80 lg:w-96 bg-gray-850 p-4 md:p-6 border-l border-gray-700 overflow-y-auto custom-scrollbar flex-shrink-0",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("h2",{className:"text-xl font-semibold text-indigo-400 flex items-center",children:[(0,l.jsx)(s.VSk,{className:"mr-2"})," Settings"]}),(0,l.jsxs)("button",{onClick:L,className:"text-sm text-red-400 hover:text-red-300 flex items-center",title:"Clear Chat History",disabled:c&&!I.current,children:[(0,l.jsx)(s.IXo,{className:"mr-1"})," Clear Chat"]})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("label",{htmlFor:"endpoint-select",className:"block text-sm font-medium text-gray-300 mb-1",children:"API Endpoint"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("select",{id:"endpoint-select",value:m,onChange:e=>{const t=e.target.value;u(t);const a=o.find((e=>e.id===t));a&&x(a.defaultModelId)},className:"w-full p-2.5 border border-gray-600 rounded bg-gray-700 text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 appearance-none pr-8",children:o.map((e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)))}),(0,l.jsx)(s.fK4,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("label",{htmlFor:"model-select",className:"block text-sm font-medium text-gray-300 mb-1",children:"Model"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("select",{id:"model-select",value:g,onChange:e=>x(e.target.value),className:"w-full p-2.5 border border-gray-600 rounded bg-gray-700 text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 appearance-none pr-8",children:D.map((e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)))}),(0,l.jsx)(s.fK4,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]}),(0,l.jsx)(A,{label:"Temperature",type:"range",value:p,onChange:e=>h(parseFloat(e.target.value)),step:"0.01",min:"0",max:"2",showValue:!0}),(0,l.jsx)(A,{label:"Max Tokens (ignored by Groq in stream)",type:"number",value:b,onChange:e=>f(parseInt(e.target.value,10)),min:"1"}),(0,l.jsx)(A,{label:"Top P",type:"range",value:v,onChange:e=>w(parseFloat(e.target.value)),step:"0.01",min:"0",max:"1",showValue:!0}),(0,l.jsx)(A,{label:"Stop Sequence(s) (comma-sep)",type:"text",value:y,onChange:e=>j(e.target.value)}),(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsxs)("button",{onClick:L,className:"w-full bg-red-600 text-white p-2.5 rounded-lg hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:outline-none transition-colors duration-150 flex items-center justify-center",disabled:c&&!I.current,children:[(0,l.jsx)(s.IXo,{className:"mr-2"})," Clear History"]})})]})]})}}}]);
//# sourceMappingURL=314.97b52043.chunk.js.map